(function(e){function t(t){for(var o,i,a=t[0],u=t[1],s=t[2],f=0,b=[];f<a.length;f++)i=a[f],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&b.push(r[i][0]),r[i]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(e[o]=u[o]);l&&l(t);while(b.length)b.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],o=!0,a=1;a<n.length;a++){var u=n[a];0!==r[u]&&(o=!1)}o&&(c.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},c=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/oauth-login/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var l=u;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),r={key:0,class:"loading"},c=Object(o["g"])("h2",null,"Loading...",-1),i={style:{display:"flex","justify-content":"center","padding-top":"3rem"}},a={class:"mb-3"},u=Object(o["g"])("p",{class:"mt-4"},"此web程式將取得您的gmail信箱、FB大頭貼、FB名稱，僅作展示用途，不以任何形式保存。請依以下步驟執行",-1),s=Object(o["g"])("ol",null,[Object(o["g"])("li",null,"1. 登入Google帳號"),Object(o["g"])("li",null,"2. 登入Facebook帳號"),Object(o["g"])("li",null,"3. 登入成功後將寄送信件至Gmail通知")],-1);function l(e,t,n,l,f,b){var g=Object(o["n"])("Profile"),d=Object(o["n"])("OAuth");return Object(o["j"])(),Object(o["d"])(o["a"],null,[l.loading?(Object(o["j"])(),Object(o["d"])("div",r,[c])):Object(o["e"])("",!0),Object(o["g"])("section",i,[Object(o["g"])("div",null,[Object(o["g"])("div",a,[Object(o["g"])(g)]),Object(o["g"])(d),u,s])])],64)}var f=n("5502"),b=Object(o["f"])("Google SignIn"),g=Object(o["f"])("FB SignIn"),d=Object(o["f"])("Sign Out");function p(e,t,n,r,c,i){var a=Object(o["n"])("Button");return Object(o["j"])(),Object(o["d"])(o["a"],null,[r.isGoogleSignin||r.isFBSignin?Object(o["e"])("",!0):(Object(o["j"])(),Object(o["d"])(a,{key:0,class:"btn",onClick:t[1]||(t[1]=function(e){return r.userSignin("google")})},{default:Object(o["q"])((function(){return[b]})),_:1})),r.isGoogleSignin&&!r.isFBSignin?(Object(o["j"])(),Object(o["d"])(a,{key:1,class:"btn",onClick:t[2]||(t[2]=function(e){return r.userSignin("facebook")})},{default:Object(o["q"])((function(){return[g]})),_:1})):Object(o["e"])("",!0),r.isGoogleSignin||r.isFBSignin?(Object(o["j"])(),Object(o["d"])(a,{key:2,class:"btn",onClick:r.userSignout},{default:Object(o["q"])((function(){return[d]})),_:1},8,["onClick"])):Object(o["e"])("",!0)],64)}n("159b"),n("b64b"),n("5319"),n("ac1f"),n("caad"),n("2532"),n("b0c0"),n("99af"),n("d3b7");var j=n("bc3a"),O=n.n(j),h=O.a.create({baseURL:"https://mail-to.herokuapp.com/",timeout:0});h.interceptors.response.use((function(e){return e}),(function(e){if(e&&e.response){var t=e.response.status;console.log("error: http ".concat(t))}else console.log("連接到服務器失敗");return Promise.reject(e.response)}));var m=h,v={send:function(e,t,n){return m.get("mailto?to=".concat(e,"&name=").concat(t,"&photo=").concat(n))}},P=n("3835");n("13d5"),n("1276"),n("841c"),n("fb6a");function y(){return location.search.replace("?","").split("&").reduce((function(e,t){var n=t.split("="),o=Object(P["a"])(n,2),r=o[0],c=o[1];return e[r]=decodeURIComponent(c),e}),{})}function S(e,t){var n=location.href,o=y();if(!Object.keys(o).includes(e)){var r=n.includes("?")?"&":"?";history.pushState({},"","".concat(n).concat(r).concat(e,"=").concat(t))}}function k(){var e=location.href,t=e.indexOf("?");history.pushState({},"",e.slice(0,t))}var w={getUrlParams:y,addUrlParam:S,clearUrlParams:k},U={class:"btn__container"},_={class:"btn__main"},A=Object(o["g"])("span",{class:"btn__circle","aria-hidden":"true"},[Object(o["g"])("span",{class:"icon arrow"})],-1),G={class:"btn__text"};function B(e,t,n,r,c,i){return Object(o["j"])(),Object(o["d"])("div",U,[Object(o["g"])("button",_,[A,Object(o["g"])("span",G,[Object(o["m"])(e.$slots,"default")])])])}var x={name:"CustomButton"};x.render=B;var C=x,F=n("260b"),I=(n("ea7b"),{apiKey:"AIzaSyDgtQrrN7yCYTFfUF8J2AWZTcj5UPvTyAI",authDomain:"auth-login-bd7cf.firebaseapp.com",projectId:"auth-login-bd7cf",storageBucket:"auth-login-bd7cf.appspot.com",messagingSenderId:"1051077604250",appId:"1:1051077604250:web:28fccac52c22eaf54a0023",measurementId:"G-BXGNZG45JG"});F["a"].initializeApp(I);var L=F["a"],T={google:"GoogleAuthProvider",facebook:"FacebookAuthProvider"},J=function(e){var t=T[e],n=new L.auth[t];return L.auth().setPersistence(L.auth.Auth.Persistence.LOCAL).then((function(){L.auth().signInWithRedirect(n)})).catch((function(e){console.log(e)}))},M=function(){return L.auth().signOut().then((function(){w.clearUrlParams()}))},R=function(){return new Promise((function(e){L.auth().onAuthStateChanged((function(t){e(t)}))}))},q={signin:J,signout:M,onAuthStateChanged:R},D={name:"OAuth",components:{Button:C},emits:{},setup:function(){var e=Object(o["l"])(!1),t=Object(o["l"])(!1),n=Object(o["k"])({google:{signin:e},facebook:{signin:t}});function r(e){l(!0),q.signin(e).catch((function(){l(!1)}))}function c(){l(!0),q.signout().then((function(){Object.keys(n).forEach((function(e){n[e].signin=!1})),g(),l(!1)}))}function i(){q.onAuthStateChanged().then((function(e){if(l(!1),e){var t=e.providerData[0].providerId;a(t,e)}}))}function a(e,t){if(e=e.replace(".com",""),e.includes("google")){var o=t.email;w.addUrlParam("to",o)}else if(e.includes("facebook")){var r=t.displayName,c=t.photoURL;u(r,c),w.addUrlParam("name",r),w.addUrlParam("photo",c)}var i=w.getUrlParams();b(i),n[e].signin=!0}function u(e,t){var n=w.getUrlParams();n.name||v.send(n.to,e,t).then((function(){console.log("send success")})).catch((function(e){console.log(e)}))}Object(o["i"])((function(){i()}));var s=Object(f["b"])();function l(e){s.commit("switchLoading",e)}function b(e){s.commit("setUserProfile",e)}function g(){s.commit("clearUserProfile")}return{isGoogleSignin:e,isFBSignin:t,userSignin:r,userSignout:c}}};D.render=p;var N=D,z={class:"mb-1"},W={class:"mb-1"};function Z(e,t,n,r,c,i){return Object(o["j"])(),Object(o["d"])(o["a"],null,[Object(o["g"])("h3",z,Object(o["o"])(r.userProfile.to?"Gmail: ":"")+Object(o["o"])(r.userProfile.to||""),1),Object(o["g"])("h3",W,Object(o["o"])(r.userProfile.name?"Hello, ":"")+Object(o["o"])(r.userProfile.name||""),1),Object(o["g"])("div",{style:[{width:"50px",height:"50px",margin:"auto"},"background-image: url(".concat(r.userProfile.photo,")")]},null,4)],64)}var E={name:"Profile",props:{},emits:{},setup:function(){var e=Object(f["b"])(),t=Object(o["b"])((function(){return e.state.userProfile}));return{userProfile:t}}};E.render=Z;var H=E,K={name:"App",components:{OAuth:N,Profile:H},setup:function(){var e=Object(f["b"])(),t=Object(o["b"])((function(){return e.state.loading}));return{loading:t}}};n("6fd4");K.render=l;var Q=K,X=n("5530"),Y=Object(f["a"])({state:function(){return{loading:!0,userProfile:{}}},mutations:{switchLoading:function(e,t){e.loading=t},setUserProfile:function(e,t){e.userProfile=Object(X["a"])(Object(X["a"])({},e.userProfile),t)},clearUserProfile:function(e){e.userProfile={}}}}),$=Y,V=Object(o["c"])(Q);V.use($),V.mount("#app")},"6fd4":function(e,t,n){"use strict";n("93cb")},"93cb":function(e,t,n){}});
//# sourceMappingURL=app.851574c7.js.map